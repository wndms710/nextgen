
# specify a RESTART line with mles and sles...
RESTART mymesh.mles result.08257434.sles

# the speed of sound used by the acoustic eigenfunction solver 
# is set based on a priority in the following order:
#   0) if a result file is specified above, the solver will look for a record "sos_avg"
#   1) if "sos_avg" is not available, the solver will attempt to use a temperature record 
#      and set a speed of sound from sos = sqrt( gamma*R_gas*T)
#         -- GAMMA and R_GAS are both parseable parameters
#         -- by default, it will attempt to find a record named "T_avg" to set the temperature
#         -- if USE_INSTANTANEOUS_T is specified, it will instead look for "T"
#            this should always be accessible from a result file from the solver
#   2) if neither of the above records are available, the solver will request the param 
#      CONSTANT_SOS = [speed-of-sound] to gather a speed of sound

# in the following, the speed of sound is set from the instantaneous sos
USE_INSTANTANEOUS_SOS

# in the following, the speed of sound is set from the instantaneous T
#USE_INSTANTANEOUS_T
#GAMMA 1.3
#R_GAS 290.0

# we now want to compute a mode shape based on a particular 
# frequency identified.  we request to find a mode at the 
# given nominal frequency.  the eigenfunction solver will attempt 
# to precisely compute the modal frequency and eigenfunction 
# shape nearest the frequency.  the iteration sequence used 
# will occasionally converge to another modal frequency requested 
# (based on a shifted power iteration), so it helps to specify 
# a range around nominal frequency to guide the solver to converge
# to the desired frequency (using DF_RANGE)

#FIND_MODE AT_FREQUENCY 738.5 
#DF_RANGE 1.0

FIND_MODE AT_FREQUENCY 464.0 
DF_RANGE 2.0

# any standard diagnostics desired can be specified at this point 
# e.g, WRITE_IMAGE, CONDITIONAL_PROBE, PROBE
# the complex mode computed has registered variables 
# "mode_real" and "mode_imag" 

# if nothing else is specified, the solver will write a 
# result file in the current directory with the mode shape.
# this can be interrogated at a later time using charles POST 
# mode (without an eos)

# alternatively, we can request to interact through the cascade app..

# make a bunch of cuts from diffuser at 2.4863 to exit near 2.7564... 
# note WRITE_IMAGE commands must include INTERVAL 1 (for now)...

FOR i = 0 TO 50
WRITE_IMAGE NAME=images/mode-z$(i) TARGET 0.006024541798979044 0.0037703001871705055 2.593508005142212 CAMERA 0.006024008616805077 0.003769846400246024 3.015838623046875 UP 0 1 0 SIZE 1856 888 WIDTH 1.1579394340515137 GEOM PLANE 0 0 2.4863+$(i)/50*(2.7564-2.4863) 0 0 1 VAR mode_real INTERVAL 1
ENDFOR

#CONDITIONAL_PROBE NAME cprobe/mode736 SAMPLE_INTERVAL 1 WRITE_INTERVAL 1 CVAR comp(x_cv,2) VAR mode_real 
#INTERACTIVE
